name: 'E2E UI Test'

pr: none
trigger:
  - master
  - outsystems

pool:
  vmImage: "ubuntu-20.04"

resources:
  repositories:
    - repository: mobile-ui-tests
      type: github
      ref: feat/custom-working-directory
      name: OutSystems/mobile-ui-tests
      endpoint: OutSystems

stages:
  - stage: Run E2E Tests
    jobs: 
    - job: checkout_repos
      steps:
      - checkout: self
      - checkout: mobile-ui-tests
    - template: pipelines/templates/android-plugin-stage-template.yml@mobile-ui-tests
      parameters:
        WORKING_DIR: $(System.DefaultWorkingDirectory)/mobile-ui-tests
        jobName: Camera
        DATACENTER: eu
        DEVICE_VERSION: 11
        MABS: 9
        PLUGIN_NAME: camera
        TAGS: '@p0'
        RETRY: 1
        THREADS: 3
        DEVICE: 'samsung or google'
        checkChanges: false